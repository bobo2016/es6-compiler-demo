<!DOCTYPE html>
<html>
<head>
	<title>ES6 compiler demo</title>

	<!-- Load Traceur compiler-->
	<script src="http://google.github.io/traceur-compiler/bin/traceur.js"
	        type="text/javascript"></script>
	<!-- Traceur compliler for web page -->
	<script src="http://google.github.io/traceur-compiler/src/bootstrap.js"
	        type="text/javascript"></script>
	<script>
	        //traceur.options.experimental = true;
	</script>

	<!-- Customize -->
	<script type="module">
	'use strict'
		//class
		class Calc {
			constructor(){
				console.log('Calc constructor');
			}

			add(a,b){
				return a + b;
			}
		}

		var c = new Calc();
		console.log(c.add(4,5));


		//string template
		var name = "Charles", time = "today";
		`Hello {name}, how are {time}`;

		//destructring
		var [a,,b] =[1,2,3];
		console.log([a,,b]);

		var [a] = [];
		console.log(a === undefined); 

		//default + rest + spread
		function f(x, y=12){
			return x + y;
		}
		console.log(f(3) === 15);

		function g(x, ...y){
			return x * y.length;
		}
		console.log(g(3, "hello", true) == 6)

		//let + const
		/*function f(){
			{
				let x;
				{
					const x = "sneaky";
					x = "foo"
				}
				let x = "inner";
			}
		}*/

		//For .. of
		var arr = [1,2,3,4];
		for(var i of arr){
			console.log(i);
		} 

		for(var key in arr){
			console.log(key + ": " + arr[key]);
		}


		//Map + Set + WeakMap + WeakSet
		//Sets
		var s = new Set();
		s.add("hello").add("goodbye").add("hello");
		console.log(s);
		console.log(s.size);
		console.log(s.has("hello") === true);

		var m = new Map();
		m.set("hello",42);
		m.set(s,34);
		m.get(s) == 34;
		console.log(m.get(s));


		//promises
		function timeout(duration = 0) {
		    return new Promise((resolve, reject) => {
		        setTimeout(resolve, duration);
		    })
		}

		var p = timeout(1000).then(() => {
		    return timeout(2000);
		}).then(() => {
		    throw new Error("hmm");
		}).catch(err => {
		    return Promise.all([timeout(100), timeout(200)]);
		})

		console.log(p);


	</script>

</head>

<body>

</body>
</html>